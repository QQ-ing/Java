# Defining Microservice Components

## Service Discovery

### DNS

DNS maps the name with the IP address. Multiple addresses can be mapped to a single service.

### Discovery service need
* Services should be able to register or deregister their availability
* Services should be able to communicate their changes to other services
* Services should be able to locate a single instance of a particular service

Solutions of discovery services

* Etcd by CoreOS
* Eureka by Netflix
* Consul by HashiCorp
* Apache ZooKeeper
* SkyDNS
* SmartStack by Airbnb

### Registry/deregistry of services

Any new service coming into existence or one that is destroyed or pulled out for maintenance should be aware of every event happening with its client. The following are the two types of registering mechanism:

* Self-registration
* Third-party registration

In self-registration, each microservice coming up in the system should register itself to the discovery service. While shutting down, it should also notify the discovery service. With these, the notification discovery service marks services as available or not available. Self-registry looks like a simple and clean solution for this, but it contradicts the single responsibility principle. Microservice will have one more responsibility of notifying the discovery service about its events.

In third-party registration, a separate process along with service discovery is responsible for keeping an eye on all the microservices running. This new process uses different mechanism to check the healthiness of the microservice such as poll, heartbeat, or hitting microservice health URL, and updates information in it. It should have some mechanism in place to detect the failing of any microservice.

### Discovering other services

* Client-side discovery

In the client-side discovery pattern, each microservice will communicate with the discovery service directly. In this pattern, the service gets the network location of all other services and their instance location from the discovery service before making the request to the required service. After getting the locations, the calling service is supposed to have smartness in choosing the proper instance of the required service by implementing some load balancing algorithms.

* Server-side discovery

In the server-side discovery pattern, services will make a request to a single middleware entity, such as a load balancer or gateway. This gateway will communicate with the discovery service to locate the required service, and use logic to find the exact instance to talk with. The API gateway is supposed to have the logic of managing the traffic load and choosing the best instance of that particular service. It is aligned with a single responsibility rule for microservices. Microservices can focus on their business logic itself.

## API Gateway

### Authentication

### Different protocol

### Load-balancing

### Request dispatching (including service discovery)

### Response transformation

### Circuit breaker

### Pros and cons of API Gateway
